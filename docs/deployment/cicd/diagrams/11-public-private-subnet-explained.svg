<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 1400">
  <defs>
    <style>
      .title { font: bold 26px sans-serif; fill: #2c3e50; }
      .subtitle { font: bold 20px sans-serif; fill: #34495e; }
      .section-title { font: bold 16px sans-serif; fill: #2c3e50; }
      .label { font: 14px sans-serif; fill: #2c3e50; }
      .small-text { font: 12px sans-serif; fill: #555; }
      .code { font: 12px monospace; fill: #e74c3c; }
      .highlight { font: bold 14px sans-serif; fill: #e74c3c; }
      .comment { font: 12px sans-serif; fill: #7f8c8d; font-style: italic; }
      
      .question-box { fill: #ffe082; stroke: #ffa000; stroke-width: 3; }
      .answer-box { fill: #c5e1a5; stroke: #689f38; stroke-width: 3; }
      .route-table-box { fill: #fff; stroke: #424242; stroke-width: 2; }
      .public-box { fill: #e3f2fd; stroke: #2196f3; stroke-width: 3; }
      .private-box { fill: #fff3e0; stroke: #ff9800; stroke-width: 3; }
      .security-box { fill: #ffcdd2; stroke: #e53935; stroke-width: 2; }
      .ha-box { fill: #f3e5f5; stroke: #9c27b0; stroke-width: 2; }
      
      .arrow { fill: none; stroke: #34495e; stroke-width: 2; marker-end: url(#arrowhead); }
      .arrow-green { fill: none; stroke: #4caf50; stroke-width: 3; marker-end: url(#arrowhead-green); }
      .arrow-red { fill: none; stroke: #e74c3c; stroke-width: 3; marker-end: url(#arrowhead-red); }
      .arrow-block { fill: none; stroke: #e74c3c; stroke-width: 4; }
    </style>
    
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#34495e" />
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4caf50" />
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#e74c3c" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="800" y="40" text-anchor="middle" class="title">Public vs Private Subnet 구분 원리와 필요성</text>

  <!-- Section 1: How to Distinguish -->
  <text x="50" y="80" class="subtitle">1. Public과 Private 구분 방법 (라우트 테이블이 결정)</text>
  
  <!-- Question Box -->
  <rect x="50" y="100" width="750" height="80" rx="5" class="question-box"/>
  <text x="425" y="130" text-anchor="middle" class="section-title">Q: 화면의 4개 서브넷이 모두 Public인 이유는?</text>
  <text x="425" y="155" text-anchor="middle" class="label">A: AWS Default VPC는 모든 서브넷에 Internet Gateway 라우트가 설정되어 있기 때문</text>

  <!-- Public Subnet Example -->
  <rect x="50" y="200" width="750" height="180" rx="5" class="public-box"/>
  <text x="425" y="230" text-anchor="middle" class="section-title">Public Subnet (현재 화면의 4개 서브넷 모두 해당)</text>
  
  <rect x="80" y="250" width="690" height="120" rx="3" class="route-table-box"/>
  <text x="100" y="275" class="label">라우트 테이블 설정:</text>
  <text x="120" y="300" class="code">대상 (Destination): 0.0.0.0/0</text>
  <text x="120" y="325" class="code">타겟 (Target): Internet Gateway (igw-xxxxx)</text>
  
  <text x="120" y="355" class="highlight">= 모든 외부 트래픽(0.0.0.0/0)이 IGW로 직접 전달</text>
  
  <path d="M 550 300 L 650 300" class="arrow-green"/>
  <text x="680" y="285" class="small-text" fill="#4caf50">인터넷 직접 연결</text>
  <text x="680" y="305" class="small-text" fill="#4caf50">외부에서 접근 가능</text>
  <text x="680" y="325" class="small-text" fill="#4caf50">(Public IP 필요)</text>

  <!-- Private Subnet Example -->
  <rect x="850" y="200" width="700" height="180" rx="5" class="private-box"/>
  <text x="1200" y="230" text-anchor="middle" class="section-title">Private Subnet (우리가 새로 만들어야 할 것)</text>
  
  <rect x="880" y="250" width="640" height="120" rx="3" class="route-table-box"/>
  <text x="900" y="275" class="label">라우트 테이블 설정:</text>
  <text x="920" y="300" class="code">대상 (Destination): 0.0.0.0/0</text>
  <text x="920" y="325" class="code">타겟 (Target): NAT Gateway (nat-xxxxx)</text>
  
  <text x="920" y="355" class="highlight">= 외부 트래픽이 NAT Gateway로 전달 (IGW 아님!)</text>
  
  <line x1="1350" y1="300" x2="1430" y2="300" stroke="#e74c3c" stroke-width="4"/>
  <line x1="1430" y1="290" x2="1430" y2="310" stroke="#e74c3c" stroke-width="4"/>
  <text x="1450" y="285" class="small-text" fill="#e74c3c">외부에서 직접</text>
  <text x="1450" y="305" class="small-text" fill="#e74c3c">접근 불가 (보안)</text>
  <text x="1450" y="325" class="small-text" fill="#e74c3c">(Public IP 불필요)</text>

  <!-- Section 2: Why We Need This Structure -->
  <text x="50" y="430" class="subtitle">2. 왜 2 Public + 2 Private 구조가 필요한가?</text>

  <!-- Security Reason -->
  <rect x="50" y="460" width="750" height="280" rx="5" class="security-box" opacity="0.1"/>
  <text x="425" y="490" text-anchor="middle" class="section-title">이유 1: 보안 (Security)</text>
  
  <rect x="80" y="510" width="320" height="210" rx="3" fill="#fff" stroke="#4caf50" stroke-width="2"/>
  <text x="240" y="535" text-anchor="middle" class="label">Public Subnet</text>
  <text x="240" y="555" text-anchor="middle" class="small-text">(외부 노출 허용 영역)</text>
  
  <text x="100" y="585" class="small-text">배포 대상:</text>
  <text x="110" y="605" class="code">1. ALB (Load Balancer)</text>
  <text x="120" y="625" class="small-text">- 외부 사용자 요청 받음</text>
  <text x="120" y="640" class="small-text">- Public IP 필요</text>
  
  <text x="110" y="670" class="code">2. NAT Gateway</text>
  <text x="120" y="690" class="small-text">- Private에서 외부 접근용</text>
  <text x="120" y="705" class="small-text">- Public IP 필요</text>

  <path d="M 400 610 L 440 610" class="arrow-green"/>

  <rect x="440" y="510" width="340" height="210" rx="3" fill="#fff" stroke="#ff9800" stroke-width="2"/>
  <text x="610" y="535" text-anchor="middle" class="label">Private Subnet</text>
  <text x="610" y="555" text-anchor="middle" class="small-text">(외부 노출 차단 영역)</text>
  
  <text x="460" y="585" class="small-text">배포 대상:</text>
  <text x="470" y="605" class="code">1. ECS Task (애플리케이션)</text>
  <text x="480" y="625" class="small-text">- Spring Boot 컨테이너</text>
  <text x="480" y="640" class="small-text">- 외부 직접 접근 불가</text>
  <text x="480" y="655" class="small-text">- ALB를 통해서만 접근</text>
  
  <text x="470" y="685" class="code">2. RDS (데이터베이스)</text>
  <text x="480" y="705" class="small-text">- 외부 직접 접근 불가</text>

  <text x="425" y="755" text-anchor="middle" class="highlight">핵심: 해킹 공격은 Public에서 막고, 민감한 데이터는 Private에 보호</text>

  <!-- High Availability Reason -->
  <rect x="850" y="460" width="700" height="280" rx="5" class="ha-box" opacity="0.1"/>
  <text x="1200" y="490" text-anchor="middle" class="section-title">이유 2: 고가용성 (High Availability)</text>
  
  <!-- AZ-A Failure Scenario -->
  <rect x="880" y="520" width="280" height="90" rx="3" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="1020" y="545" text-anchor="middle" class="label">AZ-A (ap-northeast-2a)</text>
  <text x="900" y="570" class="code">Public Subnet A</text>
  <text x="900" y="590" class="code">Private Subnet C</text>
  <text x="1020" y="605" text-anchor="middle" class="small-text" fill="#c62828">장애 발생</text>
  
  <!-- AZ-C Normal -->
  <rect x="1220" y="520" width="280" height="90" rx="3" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
  <text x="1360" y="545" text-anchor="middle" class="label">AZ-C (ap-northeast-2c)</text>
  <text x="1240" y="570" class="code">Public Subnet B</text>
  <text x="1240" y="590" class="code">Private Subnet D</text>
  <text x="1360" y="605" text-anchor="middle" class="small-text" fill="#2e7d32">정상 작동</text>

  <path d="M 1160 565 L 1220 565" class="arrow-green"/>
  <text x="1175" y="555" class="small-text" fill="#4caf50">자동 전환</text>

  <rect x="880" y="630" width="620" height="90" rx="3" fill="#fff9c4" stroke="#f57f17" stroke-width="2"/>
  <text x="1190" y="655" text-anchor="middle" class="label">고가용성 원리</text>
  <text x="900" y="680" class="small-text">1. ALB가 자동으로 정상 AZ로 트래픽 전달</text>
  <text x="900" y="700" class="small-text">2. ECS Task가 정상 AZ에서 계속 실행</text>
  <text x="900" y="715" class="small-text">3. 서비스 중단 없이 계속 운영 (99.99% 가용성)</text>

  <!-- Section 3: Traffic Flow Comparison -->
  <text x="50" y="790" class="subtitle">3. 트래픽 흐름 비교: All Public vs Public+Private</text>

  <!-- Bad Architecture -->
  <rect x="50" y="820" width="750" height="280" rx="5" fill="#ffebee" stroke="#c62828" stroke-width="3"/>
  <text x="425" y="850" text-anchor="middle" class="section-title">BAD: 모두 Public (현재 Default VPC 상태)</text>
  
  <rect x="80" y="880" width="180" height="80" rx="3" fill="#fff" stroke="#424242" stroke-width="2"/>
  <text x="170" y="905" text-anchor="middle" class="label">Internet</text>
  <text x="170" y="925" text-anchor="middle" class="small-text">외부 공격자</text>
  
  <path d="M 260 920 L 340 920" class="arrow-red"/>
  <text x="280" y="910" class="small-text" fill="#e74c3c">직접 공격 가능</text>
  
  <rect x="340" y="880" width="180" height="80" rx="3" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
  <text x="430" y="905" text-anchor="middle" class="label">ALB</text>
  <text x="430" y="925" text-anchor="middle" class="small-text">(Public)</text>
  
  <path d="M 520 920 L 570 920" class="arrow-red"/>
  <text x="530" y="910" class="small-text" fill="#e74c3c">직접 공격 가능</text>
  
  <rect x="570" y="880" width="180" height="80" rx="3" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
  <text x="660" y="905" text-anchor="middle" class="label">ECS Task</text>
  <text x="660" y="925" text-anchor="middle" class="small-text">(Public)</text>
  
  <rect x="340" y="980" width="180" height="80" rx="3" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
  <text x="430" y="1005" text-anchor="middle" class="label">RDS</text>
  <text x="430" y="1025" text-anchor="middle" class="small-text">(Public)</text>
  
  <path d="M 660 960 L 520 980" class="arrow-red"/>
  <text x="550" y="970" class="small-text" fill="#e74c3c">직접 공격 가능</text>
  
  <text x="425" y="1085" text-anchor="middle" class="highlight" fill="#c62828">위험: 모든 리소스가 외부에 노출 = 해킹 위험 극대화</text>

  <!-- Good Architecture -->
  <rect x="850" y="820" width="700" height="280" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="3"/>
  <text x="1200" y="850" text-anchor="middle" class="section-title">GOOD: Public + Private 분리</text>
  
  <rect x="880" y="880" width="150" height="80" rx="3" fill="#fff" stroke="#424242" stroke-width="2"/>
  <text x="955" y="905" text-anchor="middle" class="label">Internet</text>
  <text x="955" y="925" text-anchor="middle" class="small-text">외부 공격자</text>
  
  <path d="M 1030 920 L 1100 920" class="arrow-green"/>
  <text x="1050" y="910" class="small-text" fill="#4caf50">허용</text>
  
  <rect x="1100" y="880" width="150" height="80" rx="3" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
  <text x="1175" y="905" text-anchor="middle" class="label">ALB</text>
  <text x="1175" y="925" text-anchor="middle" class="small-text">(Public)</text>
  
  <path d="M 1250 920 L 1300 920" class="arrow-green"/>
  <text x="1260" y="910" class="small-text" fill="#4caf50">ALB만 통과</text>
  
  <rect x="1300" y="880" width="150" height="80" rx="3" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
  <text x="1375" y="905" text-anchor="middle" class="label">ECS Task</text>
  <text x="1375" y="925" text-anchor="middle" class="small-text">(Private)</text>
  
  <rect x="1300" y="980" width="150" height="80" rx="3" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
  <text x="1375" y="1005" text-anchor="middle" class="label">RDS</text>
  <text x="1375" y="1025" text-anchor="middle" class="small-text">(Private)</text>
  
  <path d="M 1375 960 L 1375 980" class="arrow-green"/>
  
  <!-- Block arrows -->
  <line x1="1030" y1="1020" x2="1100" y2="1020" class="arrow-block"/>
  <line x1="1100" y1="1010" x2="1100" y2="1030" class="arrow-block"/>
  <text x="1030" y="1050" class="small-text" fill="#e74c3c">직접 접근 차단</text>
  
  <text x="1200" y="1085" text-anchor="middle" class="highlight" fill="#2e7d32">안전: ALB만 외부 노출, 앱과 DB는 완전히 보호</text>

  <!-- Section 4: Action Items -->
  <rect x="50" y="1130" width="1500" height="240" rx="5" fill="#fff9c4" stroke="#f57f17" stroke-width="3"/>
  <text x="800" y="1165" text-anchor="middle" class="section-title">4. 옵션 2 실행 계획 (기존 VPC 활용)</text>
  
  <text x="80" y="1195" class="label">현재 상태:</text>
  <text x="100" y="1220" class="code">VPC: 172.31.0.0/16 (Default VPC)</text>
  <text x="100" y="1240" class="code">서브넷 4개: 모두 Public (172.31.0.0/20, 172.31.16.0/20, 172.31.32.0/20, 172.31.48.0/20)</text>
  <text x="100" y="1260" class="code">가용 영역: ap-northeast-2a, 2b, 2c, 2d</text>
  
  <text x="80" y="1290" class="label">해야 할 작업:</text>
  <rect x="100" y="1300" width="1420" height="60" rx="3" fill="#fff" stroke="#f57f17" stroke-width="2"/>
  <text x="120" y="1325" class="highlight">1. Private Subnet 2개 추가 생성 (서로 다른 AZ, 예: 2a와 2c)</text>
  <text x="120" y="1345" class="highlight">2. NAT Gateway 2개 생성 (각 Public Subnet에 1개씩)</text>
  <text x="900" y="1325" class="highlight">3. Private Subnet용 라우트 테이블 생성 (0.0.0.0/0 → NAT Gateway)</text>
  <text x="900" y="1345" class="highlight">4. 기존 Public Subnet 중 2개 선택 (ALB 배포용)</text>

  <!-- Summary -->
  <text x="800" y="1395" text-anchor="middle" class="label" fill="#c62828">핵심: Public/Private 구분은 라우트 테이블이 결정 | Public+Private 분리는 보안과 고가용성을 위한 필수 구조</text>
</svg>