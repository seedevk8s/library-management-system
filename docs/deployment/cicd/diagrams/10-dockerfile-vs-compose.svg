<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1100">
  <!-- Title -->
  <text x="700" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#232F3E">
    Dockerfile vs docker-compose.yml 역할 비교
  </text>
  <text x="700" y="55" font-size="14" text-anchor="middle" fill="#666">
    Single Container Image vs Multi-Container Orchestration
  </text>

  <!-- Comparison Table -->
  <g id="comparison-table">
    <rect x="50" y="80" width="1300" height="180" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" rx="8"/>
    
    <!-- Headers -->
    <rect x="60" y="90" width="150" height="40" fill="#495057" rx="5"/>
    <text x="135" y="115" font-size="13" font-weight="bold" text-anchor="middle" fill="#fff">구분</text>
    
    <rect x="220" y="90" width="520" height="40" fill="#0d6efd" rx="5"/>
    <text x="480" y="115" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Dockerfile</text>
    
    <rect x="750" y="90" width="590" height="40" fill="#198754" rx="5"/>
    <text x="1045" y="115" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">docker-compose.yml</text>
    
    <!-- Row 1: 핵심 역할 -->
    <rect x="60" y="140" width="150" height="35" fill="#e9ecef"/>
    <text x="135" y="162" font-size="11" font-weight="bold" text-anchor="middle" fill="#212529">핵심 역할</text>
    
    <rect x="220" y="140" width="520" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="480" y="162" font-size="11" text-anchor="middle" fill="#212529">단일 이미지 빌드 레시피</text>
    
    <rect x="750" y="140" width="590" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="1045" y="162" font-size="11" text-anchor="middle" fill="#212529">여러 컨테이너 실행 및 연결 오케스트레이션</text>
    
    <!-- Row 2: 목적 -->
    <rect x="60" y="175" width="150" height="35" fill="#e9ecef"/>
    <text x="135" y="197" font-size="11" font-weight="bold" text-anchor="middle" fill="#212529">목적</text>
    
    <rect x="220" y="175" width="520" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="480" y="197" font-size="11" text-anchor="middle" fill="#212529">HOW TO BUILD (어떻게 만들까?)</text>
    
    <rect x="750" y="175" width="590" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="1045" y="197" font-size="11" text-anchor="middle" fill="#212529">HOW TO RUN (어떻게 실행하고 연결할까?)</text>
    
    <!-- Row 3: 대상 -->
    <rect x="60" y="210" width="150" height="35" fill="#e9ecef"/>
    <text x="135" y="232" font-size="11" font-weight="bold" text-anchor="middle" fill="#212529">대상</text>
    
    <rect x="220" y="210" width="520" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="480" y="232" font-size="11" text-anchor="middle" fill="#212529">1개 컨테이너 이미지</text>
    
    <rect x="750" y="210" width="590" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="1045" y="232" font-size="11" text-anchor="middle" fill="#212529">여러 컨테이너 (App + DB + Redis 등)</text>
    
    <!-- Row 4: 비유 -->
    <rect x="60" y="245" width="150" height="35" fill="#e9ecef"/>
    <text x="135" y="267" font-size="11" font-weight="bold" text-anchor="middle" fill="#212529">비유</text>
    
    <rect x="220" y="245" width="520" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="480" y="267" font-size="11" text-anchor="middle" fill="#212529">요리 레시피 (재료 + 조리법)</text>
    
    <rect x="750" y="245" width="590" height="35" fill="#fff" stroke="#dee2e6"/>
    <text x="1045" y="267" font-size="11" text-anchor="middle" fill="#212529">코스 요리 메뉴 구성 (전채 + 메인 + 디저트)</text>
  </g>

  <!-- Left Side: Dockerfile -->
  <g id="dockerfile-section">
    <rect x="50" y="290" width="640" height="770" fill="#e7f1ff" stroke="#0d6efd" stroke-width="3" rx="10"/>
    <text x="370" y="320" font-size="18" font-weight="bold" text-anchor="middle" fill="#0d47a1">Dockerfile</text>
    <text x="370" y="343" font-size="12" text-anchor="middle" fill="#666">단일 이미지 빌드 명령서</text>
    
    <!-- Dockerfile Structure -->
    <rect x="70" y="365" width="600" height="680" fill="#fff" stroke="#0d6efd" stroke-width="2" rx="8"/>
    
    <!-- Stage 1: Build -->
    <rect x="90" y="385" width="560" height="280" fill="#fff3cd" stroke="#ffc107" stroke-width="2" rx="5"/>
    <text x="100" y="410" font-size="14" font-weight="bold" fill="#856404">Stage 1: Build (빌드 단계)</text>
    
    <rect x="110" y="425" width="520" height="230" fill="#fff" stroke="#dee2e6" rx="3"/>
    <text x="120" y="445" font-size="11" font-family="monospace" fill="#212529">FROM gradle:8.5-jdk17 AS builder</text>
    <text x="120" y="465" font-size="11" font-family="monospace" fill="#212529">WORKDIR /app</text>
    <text x="120" y="485" font-size="11" font-family="monospace" fill="#6c757d"># Gradle 파일 복사 (의존성 캐싱)</text>
    <text x="120" y="505" font-size="11" font-family="monospace" fill="#212529">COPY build.gradle settings.gradle ./</text>
    <text x="120" y="525" font-size="11" font-family="monospace" fill="#212529">COPY gradle ./gradle</text>
    <text x="120" y="545" font-size="11" font-family="monospace" fill="#6c757d"># 의존성 다운로드 (캐싱 최적화)</text>
    <text x="120" y="565" font-size="11" font-family="monospace" fill="#212529">RUN gradle dependencies --no-daemon</text>
    <text x="120" y="585" font-size="11" font-family="monospace" fill="#6c757d"># 소스 코드 복사 및 빌드</text>
    <text x="120" y="605" font-size="11" font-family="monospace" fill="#212529">COPY src ./src</text>
    <text x="120" y="625" font-size="11" font-family="monospace" fill="#198754">RUN gradle clean build -x test</text>
    <text x="120" y="645" font-size="11" font-family="monospace" fill="#6c757d"># 결과물: JAR 파일</text>
    
    <!-- Arrow -->
    <path d="M 370 670 L 370 700" stroke="#ffc107" stroke-width="3" marker-end="url(#arrow-yellow)"/>
    <defs>
      <marker id="arrow-yellow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
        <path d="M0,0 L0,6 L9,3 z" fill="#ffc107" />
      </marker>
    </defs>
    
    <!-- Stage 2: Runtime -->
    <rect x="90" y="705" width="560" height="320" fill="#d1ecf1" stroke="#0dcaf0" stroke-width="2" rx="5"/>
    <text x="100" y="730" font-size="14" font-weight="bold" fill="#055160">Stage 2: Runtime (실행 단계)</text>
    
    <rect x="110" y="745" width="520" height="265" fill="#fff" stroke="#dee2e6" rx="3"/>
    <text x="120" y="765" font-size="11" font-family="monospace" fill="#212529">FROM eclipse-temurin:17-jre-alpine</text>
    <text x="120" y="785" font-size="11" font-family="monospace" fill="#212529">WORKDIR /app</text>
    <text x="120" y="805" font-size="11" font-family="monospace" fill="#6c757d"># 보안: Non-root 사용자 생성</text>
    <text x="120" y="825" font-size="11" font-family="monospace" fill="#212529">RUN addgroup -S spring &amp;&amp; \</text>
    <text x="120" y="845" font-size="11" font-family="monospace" fill="#212529">    adduser -S spring -G spring</text>
    <text x="120" y="865" font-size="11" font-family="monospace" fill="#6c757d"># 빌드 단계에서 JAR 복사</text>
    <text x="120" y="885" font-size="11" font-family="monospace" fill="#198754">COPY --from=builder /app/build/libs/*.jar app.jar</text>
    <text x="120" y="905" font-size="11" font-family="monospace" fill="#212529">USER spring:spring</text>
    <text x="120" y="925" font-size="11" font-family="monospace" fill="#212529">EXPOSE 8081</text>
    <text x="120" y="945" font-size="11" font-family="monospace" fill="#6c757d"># Health Check 설정</text>
    <text x="120" y="965" font-size="11" font-family="monospace" fill="#212529">HEALTHCHECK --interval=30s ...</text>
    <text x="120" y="985" font-size="11" font-family="monospace" fill="#0d6efd">ENTRYPOINT ["java", "-jar", "app.jar"]</text>
    
    <!-- Result -->
    <rect x="90" y="1025" width="560" height="15" fill="#0d6efd" rx="3"/>
    <text x="370" y="1036" font-size="10" font-weight="bold" text-anchor="middle" fill="#fff">결과물: library-app 이미지 (1개)</text>
  </g>

  <!-- Right Side: docker-compose.yml -->
  <g id="docker-compose-section">
    <rect x="710" y="290" width="640" height="770" fill="#d1e7dd" stroke="#198754" stroke-width="3" rx="10"/>
    <text x="1030" y="320" font-size="18" font-weight="bold" text-anchor="middle" fill="#0a3622">docker-compose.yml</text>
    <text x="1030" y="343" font-size="12" text-anchor="middle" fill="#666">멀티 컨테이너 오케스트레이션</text>
    
    <!-- docker-compose Structure -->
    <rect x="730" y="365" width="600" height="680" fill="#fff" stroke="#198754" stroke-width="2" rx="8"/>
    
    <!-- Services Section -->
    <rect x="750" y="385" width="560" height="380" fill="#f8d7da" stroke="#dc3545" stroke-width="2" rx="5"/>
    <text x="760" y="410" font-size="14" font-weight="bold" fill="#721c24">services: (컨테이너 정의)</text>
    
    <!-- MySQL Service -->
    <rect x="770" y="425" width="520" height="155" fill="#fff" stroke="#0dcaf0" stroke-width="2" rx="3"/>
    <text x="780" y="445" font-size="12" font-weight="bold" fill="#055160">mysql:</text>
    <text x="790" y="465" font-size="11" font-family="monospace" fill="#212529">image: mysql:8.0</text>
    <text x="790" y="485" font-size="11" font-family="monospace" fill="#212529">container_name: library-mysql</text>
    <text x="790" y="505" font-size="11" font-family="monospace" fill="#212529">environment:</text>
    <text x="800" y="525" font-size="10" font-family="monospace" fill="#6c757d">MYSQL_ROOT_PASSWORD: 12345</text>
    <text x="800" y="542" font-size="10" font-family="monospace" fill="#6c757d">MYSQL_DATABASE: librarydb</text>
    <text x="790" y="562" font-size="11" font-family="monospace" fill="#212529">ports: ["3307:3306"]</text>
    <text x="790" y="575" font-size="11" font-family="monospace" fill="#198754">networks: [library-network]</text>
    
    <!-- Spring Boot Service -->
    <rect x="770" y="590" width="520" height="165" fill="#fff" stroke="#0d6efd" stroke-width="2" rx="3"/>
    <text x="780" y="610" font-size="12" font-weight="bold" fill="#0d47a1">app:</text>
    <text x="790" y="630" font-size="11" font-family="monospace" fill="#198754">build:</text>
    <text x="800" y="647" font-size="10" font-family="monospace" fill="#6c757d">context: .</text>
    <text x="800" y="662" font-size="10" font-family="monospace" fill="#6c757d">dockerfile: Dockerfile</text>
    <text x="790" y="682" font-size="11" font-family="monospace" fill="#212529">container_name: library-app</text>
    <text x="790" y="702" font-size="11" font-family="monospace" fill="#212529">environment:</text>
    <text x="800" y="719" font-size="10" font-family="monospace" fill="#6c757d">DB_URL: jdbc:mysql://mysql:3306/...</text>
    <text x="790" y="739" font-size="11" font-family="monospace" fill="#198754">networks: [library-network]</text>
    
    <!-- Networks Section -->
    <rect x="750" y="780" width="560" height="60" fill="#fff3cd" stroke="#ffc107" stroke-width="2" rx="5"/>
    <text x="760" y="800" font-size="14" font-weight="bold" fill="#856404">networks:</text>
    <rect x="770" y="810" width="540" height="40" fill="#fff" stroke="#dee2e6" rx="3"/>
    <text x="780" y="830" font-size="11" font-family="monospace" fill="#212529">library-network:</text>
    <text x="790" y="845" font-size="10" font-family="monospace" fill="#6c757d">driver: bridge</text>
    
    <!-- Volumes Section -->
    <rect x="750" y="855" width="560" height="60" fill="#e7f1ff" stroke="#0d6efd" stroke-width="2" rx="5"/>
    <text x="760" y="875" font-size="14" font-weight="bold" fill="#0d47a1">volumes:</text>
    <rect x="770" y="885" width="540" height="40" fill="#fff" stroke="#dee2e6" rx="3"/>
    <text x="780" y="905" font-size="11" font-family="monospace" fill="#212529">mysql-data:</text>
    <text x="790" y="920" font-size="10" font-family="monospace" fill="#6c757d">driver: local</text>
    
    <!-- Key Point Box -->
    <rect x="750" y="930" width="560" height="100" fill="#cfe2ff" stroke="#0d6efd" stroke-width="2" rx="5"/>
    <text x="760" y="950" font-size="12" font-weight="bold" fill="#0d47a1">핵심 포인트:</text>
    <text x="760" y="970" font-size="11" fill="#212529">1. services에서 Dockerfile 참조 (build:)</text>
    <text x="760" y="988" font-size="11" fill="#212529">2. 여러 컨테이너를 하나의 네트워크로 연결</text>
    <text x="760" y="1006" font-size="11" fill="#212529">3. mysql이라는 서비스 이름으로 통신 가능</text>
    <text x="760" y="1024" font-size="11" fill="#212529">4. 한 번의 명령으로 모든 컨테이너 실행</text>
    
    <!-- Result -->
    <rect x="750" y="1025" width="560" height="15" fill="#198754" rx="3"/>
    <text x="1030" y="1036" font-size="10" font-weight="bold" text-anchor="middle" fill="#fff">결과물: 2개 컨테이너 (MySQL + App) + 네트워크 + 볼륨</text>
  </g>

  <!-- Bottom: Execution Flow -->
  <rect x="50" y="1070" width="1300" height="20" fill="#6c757d" rx="5"/>
  <text x="700" y="1085" font-size="12" font-weight="bold" text-anchor="middle" fill="#fff">실행 명령: docker build -t library-app . (왼쪽) vs docker-compose up -d (오른쪽)</text>
</svg>