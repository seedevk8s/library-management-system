<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 1200">
  <defs>
    <style>
      .title { font: bold 26px sans-serif; fill: #2c3e50; }
      .subtitle { font: bold 20px sans-serif; fill: #34495e; }
      .section-title { font: bold 16px sans-serif; fill: #2c3e50; }
      .label { font: 14px sans-serif; fill: #2c3e50; }
      .small-text { font: 12px sans-serif; fill: #555; }
      .code { font: 12px monospace; fill: #e74c3c; }
      .highlight { font: bold 14px sans-serif; fill: #e74c3c; }
      
      .vpc-box { fill: #e8f5e9; stroke: #4caf50; stroke-width: 3; }
      .sg-box { fill: #e1f5fe; stroke: #0288d1; stroke-width: 3; }
      .subnet-box { fill: #fff3e0; stroke: #f57c00; stroke-width: 2; }
      .resource-box { fill: #fff; stroke: #616161; stroke-width: 2; }
      .order-box { fill: #f3e5f5; stroke: #7b1fa2; stroke-width: 2; }
      .question-box { fill: #ffe082; stroke: #f57f17; stroke-width: 3; }
      .answer-box { fill: #c5e1a5; stroke: #558b2f; stroke-width: 3; }
      
      .arrow { fill: none; stroke: #424242; stroke-width: 2; marker-end: url(#arrowhead); }
      .arrow-blue { fill: none; stroke: #0288d1; stroke-width: 3; marker-end: url(#arrowhead-blue); }
      .arrow-dashed { fill: none; stroke: #9e9e9e; stroke-width: 2; stroke-dasharray: 5,5; }
    </style>
    
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#424242" />
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#0288d1" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="800" y="40" text-anchor="middle" class="title">보안 그룹 vs 서브넷: 독립적 관계와 생성 순서</text>

  <!-- Question -->
  <rect x="50" y="70" width="1500" height="80" rx="5" class="question-box"/>
  <text x="800" y="100" text-anchor="middle" class="section-title">Q: Private Subnet을 아직 안 만들었는데, 왜 보안 그룹을 먼저 만들었나요?</text>
  <text x="800" y="130" text-anchor="middle" class="label">A: 보안 그룹은 VPC 레벨 리소스로 서브넷과 독립적입니다. 어느 순서로 만들어도 되지만, 먼저 만들면 나중에 참조하기 편합니다.</text>

  <!-- Section 1: Independence -->
  <text x="50" y="190" class="subtitle">1. 보안 그룹과 서브넷의 독립적 관계</text>

  <!-- VPC Container -->
  <rect x="50" y="220" width="1500" height="420" rx="10" class="vpc-box"/>
  <text x="80" y="250" class="section-title">VPC (vpc-07dd414387be45a0f)</text>

  <!-- Security Groups Layer -->
  <rect x="100" y="280" width="650" height="330" rx="5" class="sg-box" opacity="0.1"/>
  <text x="425" y="310" text-anchor="middle" class="section-title">보안 그룹 (Security Groups) - VPC 레벨</text>
  <text x="425" y="330" text-anchor="middle" class="small-text">어떤 서브넷에도 적용 가능 (서브넷과 독립적)</text>

  <rect x="120" y="350" width="280" height="80" rx="3" class="resource-box"/>
  <text x="260" y="375" text-anchor="middle" class="label">library-alb-sg</text>
  <text x="260" y="395" class="code">인바운드: HTTP(80), HTTPS(443)</text>
  <text x="260" y="415" class="small-text">ALB에 적용 예정</text>

  <rect x="430" y="350" width="280" height="80" rx="3" class="resource-box"/>
  <text x="570" y="375" text-anchor="middle" class="label">library-ecs-task-sg</text>
  <text x="570" y="395" class="code">인바운드: 8081 (from ALB-SG)</text>
  <text x="570" y="415" class="small-text">ECS Task에 적용 예정</text>

  <rect x="120" y="450" width="280" height="80" rx="3" class="resource-box"/>
  <text x="260" y="475" text-anchor="middle" class="label">library-rds-sg</text>
  <text x="260" y="495" class="code">인바운드: MySQL(3306) from ECS-SG</text>
  <text x="260" y="515" class="small-text">RDS에 적용 예정</text>

  <rect x="430" y="450" width="280" height="80" rx="3" class="resource-box"/>
  <text x="570" y="475" text-anchor="middle" class="label">default</text>
  <text x="570" y="495" class="code">기본 보안 그룹</text>
  <text x="570" y="515" class="small-text">VPC 생성 시 자동 생성</text>

  <text x="425" y="560" text-anchor="middle" class="highlight">이미 생성 완료 (서브넷과 무관)</text>

  <!-- Subnets Layer -->
  <rect x="800" y="280" width="700" height="330" rx="5" class="subnet-box" opacity="0.1"/>
  <text x="1150" y="310" text-anchor="middle" class="section-title">서브넷 (Subnets) - 네트워크 분할</text>
  <text x="1150" y="330" text-anchor="middle" class="small-text">보안 그룹과 독립적 (나중에 리소스 생성 시 연결)</text>

  <rect x="820" y="350" width="280" height="80" rx="3" class="resource-box"/>
  <text x="960" y="375" text-anchor="middle" class="label">Public Subnet (4개 존재)</text>
  <text x="960" y="395" class="code">172.31.0.0/20, 16.0/20</text>
  <text x="960" y="410" class="code">172.31.32.0/20, 48.0/20</text>
  <text x="960" y="425" class="small-text">AZ: 2a, 2b, 2c, 2d</text>

  <rect x="1220" y="350" width="240" height="80" rx="3" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="1340" y="375" text-anchor="middle" class="label">Private Subnet</text>
  <text x="1340" y="395" class="highlight" fill="#c62828">아직 생성 안 함</text>
  <text x="1340" y="415" class="small-text">(다음 단계에서 생성 예정)</text>

  <rect x="820" y="450" width="640" height="80" rx="3" fill="#fff9c4" stroke="#f57f17" stroke-width="2"/>
  <text x="1140" y="475" text-anchor="middle" class="label">리소스 생성 시 보안 그룹 연결</text>
  <text x="840" y="500" class="small-text">예: ALB 생성 → Public Subnet 선택 + library-alb-sg 연결</text>
  <text x="840" y="520" class="small-text">예: ECS Task 생성 → Private Subnet 선택 + library-ecs-task-sg 연결</text>

  <text x="1150" y="560" text-anchor="middle" class="highlight">Private Subnet은 다음 단계에서 생성</text>

  <!-- Relationship Arrow -->
  <path d="M 750 460 L 820 460" class="arrow-dashed"/>
  <text x="770" y="450" class="small-text">나중에 연결</text>

  <!-- Section 2: Order Explanation -->
  <text x="50" y="690" class="subtitle">2. 왜 보안 그룹을 먼저 만들었나?</text>

  <rect x="50" y="720" width="750" height="250" rx="5" class="order-box" opacity="0.1"/>
  <text x="425" y="750" text-anchor="middle" class="section-title">작업 순서의 유연성</text>

  <rect x="80" y="770" width="690" height="180" rx="3" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="100" y="800" class="label">보안 그룹을 먼저 만드는 이유:</text>
  
  <text x="120" y="830" class="code">1. VPC 레벨 리소스이므로 서브넷과 독립적</text>
  <text x="140" y="850" class="small-text">- 어느 서브넷에도 적용 가능</text>
  <text x="140" y="870" class="small-text">- Private Subnet 없어도 생성 가능</text>

  <text x="120" y="900" class="code">2. 나중에 리소스 생성 시 참조하기 편함</text>
  <text x="140" y="920" class="small-text">- ALB, ECS, RDS 생성할 때 이미 만든 보안 그룹 선택만 하면 됨</text>
  <text x="140" y="940" class="small-text">- 보안 그룹 간 참조 관계 미리 설정 가능</text>

  <!-- Alternative Orders -->
  <rect x="850" y="720" width="700" height="250" rx="5" fill="#e8f5e9" stroke="#388e3c" stroke-width="2"/>
  <text x="1200" y="750" text-anchor="middle" class="section-title">가능한 생성 순서들 (모두 정상 작동)</text>

  <rect x="880" y="770" width="640" height="180" rx="3" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  
  <text x="900" y="800" class="label">순서 1 (현재 방식):</text>
  <text x="920" y="820" class="code">VPC → 보안 그룹 4개 → Private Subnet 2개 → 리소스 생성</text>
  
  <text x="900" y="850" class="label">순서 2 (논리적 순서):</text>
  <text x="920" y="870" class="code">VPC → Private Subnet 2개 → 보안 그룹 4개 → 리소스 생성</text>
  
  <text x="900" y="900" class="label">순서 3 (동시 진행):</text>
  <text x="920" y="920" class="code">VPC → (보안 그룹 + Subnet 동시) → 리소스 생성</text>
  
  <text x="1200" y="950" text-anchor="middle" class="highlight" fill="#388e3c">어떤 순서든 결과는 동일</text>

  <!-- Section 3: Next Steps -->
  <text x="50" y="1020" class="subtitle">3. 현재 상태와 다음 단계</text>

  <rect x="50" y="1050" width="1500" height="130" rx="5" class="answer-box"/>
  <text x="800" y="1080" text-anchor="middle" class="section-title">현재 완료된 것</text>
  <text x="80" y="1110" class="label">VPC: vpc-07dd414387be45a0f (172.31.0.0/16)</text>
  <text x="80" y="1135" class="label">보안 그룹 4개: library-alb-sg, library-ecs-task-sg, library-rds-sg, default</text>
  <text x="80" y="1160" class="label">Public Subnet 4개: 172.31.0.0/20 (2a), 172.31.16.0/20 (2b), 172.31.32.0/20 (2c), 172.31.48.0/20 (2d)</text>
  
  <text x="900" y="1110" class="highlight">다음 단계:</text>
  <text x="920" y="1135" class="highlight">1. Private Subnet 2개 생성 (서로 다른 AZ)</text>
  <text x="920" y="1160" class="highlight">2. 나중에 리소스 생성 시 적절한 서브넷 + 보안 그룹 연결</text>

  <!-- Summary -->
  <rect x="50" y="1190" width="1500" height="10" fill="#7b1fa2"/>
</svg>